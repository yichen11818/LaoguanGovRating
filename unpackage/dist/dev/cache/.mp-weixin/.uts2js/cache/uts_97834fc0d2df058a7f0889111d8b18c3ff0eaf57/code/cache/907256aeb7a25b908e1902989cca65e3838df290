{"code":"import { defineComponent } from \"vue\";\nexport default defineComponent(new UTSJSONObject({\n    data() {\n        return {\n            username: '',\n            password: ''\n        };\n    },\n    methods: new UTSJSONObject({\n        handleLogin() {\n            if (!this.username || !this.password) {\n                uni.showToast({\n                    title: '请输入用户名和密码',\n                    icon: 'none'\n                });\n                return null;\n            }\n            // 调用登录云函数\n            uniCloud.callFunction({\n                name: 'user',\n                data: new UTSJSONObject({\n                    action: 'login',\n                    data: new UTSJSONObject({\n                        username: this.username,\n                        password: this.password\n                    })\n                })\n            }).then(res => {\n                const _a = res.result, code = _a.code, msg = _a.msg, data = _a.data;\n                if (code === 0) {\n                    // 登录成功\n                    // 保存用户信息和token\n                    uni.setStorageSync('token', data.token);\n                    uni.setStorageSync('userInfo', data.user);\n                    // 根据角色跳转到不同页面\n                    if (data.user.role === 'admin') {\n                        // 管理员跳转到首页\n                        uni.switchTab({\n                            url: '/pages/index/index'\n                        });\n                    }\n                    else if (data.user.role === 'rater') {\n                        // 打分成员跳转到首页\n                        uni.switchTab({\n                            url: '/pages/index/index'\n                        });\n                    }\n                    else {\n                        // 普通用户跳转到首页\n                        uni.switchTab({\n                            url: '/pages/index/index'\n                        });\n                    }\n                }\n                else {\n                    // 登录失败\n                    uni.showToast({\n                        title: msg || '登录失败',\n                        icon: 'none'\n                    });\n                }\n            }).catch((err = null) => {\n                uni.__f__('error', 'at pages/login/login.vue:86', err);\n                uni.showToast({\n                    title: '登录失败，请检查网络',\n                    icon: 'none'\n                });\n            });\n        }\n    })\n}));\n//# sourceMappingURL=C:/Users/11818/Documents/laoguan/laoguan/pages/login/login.vue?vue&type=script&lang.uts.js.map","references":[],"uniExtApis":["uni.showToast","uniCloud.callFunction","uni.setStorageSync","uni.switchTab","uni.__f__"],"map":"{\"version\":3,\"file\":\"login.vue?vue&type=script&lang.uts.js\",\"sourceRoot\":\"\",\"sources\":[\"login.vue?vue&type=script&lang.uts\"],\"names\":[],\"mappings\":\";AACC,iDAAe;IACd,IAAI;QACH,OAAO;YACN,QAAQ,EAAE,EAAE;YACZ,QAAQ,EAAE,EAAE;SACZ,CAAA;IACF,CAAC;IACD,OAAO,oBAAE;QACR,WAAW;YACV,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;gBACrC,GAAG,CAAC,SAAS,CAAC;oBACb,KAAK,EAAE,WAAW;oBAClB,IAAI,EAAE,MAAM;iBACZ,CAAC,CAAC;gBACH,YAAO;aACP;YAED,UAAU;YACV,QAAQ,CAAC,YAAY,CAAC;gBACrB,IAAI,EAAE,MAAM;gBACZ,IAAI,oBAAE;oBACL,MAAM,EAAE,OAAO;oBACf,IAAI,oBAAE;wBACL,QAAQ,EAAE,IAAI,CAAC,QAAQ;wBACvB,QAAQ,EAAE,IAAI,CAAC,QAAQ;qBACvB,CAAA;iBACD,CAAA;aACD,CAAC,CAAC,IAAI,CAAC,GAAG;gBACJ,MAAA,KAAsB,GAAG,CAAC,MAAM,EAA9B,IAAI,UAAA,EAAE,GAAG,SAAA,EAAE,IAAI,UAAe,CAAC;gBAEvC,IAAI,IAAI,KAAK,CAAC,EAAE;oBACf,OAAO;oBACP,eAAe;oBACf,GAAG,CAAC,cAAc,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;oBACxC,GAAG,CAAC,cAAc,CAAC,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;oBAE1C,cAAc;oBACd,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;wBAC/B,WAAW;wBACX,GAAG,CAAC,SAAS,CAAC;4BACb,GAAG,EAAE,oBAAoB;yBACzB,CAAC,CAAC;qBACH;yBAAM,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,KAAK,OAAO,EAAE;wBACtC,YAAY;wBACZ,GAAG,CAAC,SAAS,CAAC;4BACb,GAAG,EAAE,oBAAoB;yBACzB,CAAC,CAAC;qBACH;yBAAM;wBACN,YAAY;wBACZ,GAAG,CAAC,SAAS,CAAC;4BACb,GAAG,EAAE,oBAAoB;yBACzB,CAAC,CAAC;qBACH;iBACD;qBAAM;oBACN,OAAO;oBACP,GAAG,CAAC,SAAS,CAAC;wBACb,KAAK,EAAE,GAAG,IAAI,MAAM;wBACpB,IAAI,EAAE,MAAM;qBACZ,CAAC,CAAC;iBACH;YACF,CAAC,CAAC,CAAC,KAAK,CAAC,CAAA,GAAG,OAAA;gBACX,GAAG,CAAC,KAAK,CAAC,OAAO,EAAC,6BAA6B,EAAC,GAAG,CAAC,CAAC;gBACrD,GAAG,CAAC,SAAS,CAAC;oBACb,KAAK,EAAE,YAAY;oBACnB,IAAI,EAAE,MAAM;iBACZ,CAAC,CAAC;YACJ,CAAC,CAAC,CAAC;QACJ,CAAC;KACD,CAAA;CACD,GAAA\"}"}
